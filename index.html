<!DOCTYPE html>
<html lang="no">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nye Boligprosjekter Oslo</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600&display=swap" rel="stylesheet">
    <script src='https://api.mapbox.com/mapbox-gl-js/v3.0.1/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v3.0.1/mapbox-gl.css' rel='stylesheet' />
    <link rel="stylesheet" href="style.css?v=142">
</head>

<body>

    <!-- Video Background -->
    <video autoplay muted loop playsinline id="bg-video">
        <source src="background_video.webm" type="video/webm">
    </video>

    <!-- Floating Navigation -->
    <nav class="floating-nav">
        <div class="nav-logo">
            <img src="nybygg_logo_ny.png" alt="Innsikt Nybygg Prosjekt">
        </div>
        <div class="nav-links">
            <a href="#">Markedet</a>
            <a href="#">Mine prosjekter</a>
            <a href="#" class="contact-btn">Kontakt</a>
        </div>
    </nav>

    <!-- Main Content Layout -->
    <div class="content-container">
        <!-- Main Map Frame -->
        <main class="map-frame">
            <div id="map"></div>

            <!-- Map Controls -->
            <!-- Map Controls -->
            <!-- Controls Wrapper -->
            <div class="controls-wrapper">

                <!-- 1. Map Filters (White Box) -->
                <div class="map-controls">
                    <div class="control-group">
                        <button id="filter-active" class="control-btn active" onclick="setFilter('active')">Til salgs
                            nå</button>
                        <button id="filter-sold" class="control-btn" onclick="setFilter('sold')">Sluttsolgt</button>
                    </div>
                    <div class="control-divider"></div>
                    <div class="control-group">
                        <button id="filter-year-all" class="control-btn active" onclick="setYearFilter('all')">Alle
                            år</button>
                        <button id="filter-2026" class="control-btn" onclick="setYearFilter(2026)">Ferdig 2026</button>
                        <button id="filter-2027" class="control-btn" onclick="setYearFilter(2027)">Ferdig 2027</button>
                        <button id="filter-2028" class="control-btn" onclick="setYearFilter(2028)">Ferdig 2028</button>
                        <button id="filter-2029" class="control-btn" onclick="setYearFilter(2029)">Ferdig 2029</button>
                    </div>
                </div>

                <!-- 2. Price Growth Inputs (MOVED TO BOTTOM LEFT) -->
                <!-- REMOVED FROM HERE -->
            </div>

            <!-- 2. Price Growth Inputs (White Box, Bottom Left) -->
            <div class="growth-controls">
                <div class="growth-header"
                    style="display: flex; align-items: center; justify-content: center; gap: 10px; position: relative;">
                    ENDRE ANSLAG PRISUTVIKLING
                    <div class="info-icon"
                        onclick="document.getElementById('seasonal-info').classList.toggle('hidden')">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10"></circle>
                            <line x1="12" y1="16" x2="12" y2="12"></line>
                            <line x1="12" y1="8" x2="12.01" y2="8"></line>
                        </svg>
                    </div>
                    <div class="reset-icon" onclick="resetGrowthDefaults()" title="Tilbakestill til standard">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M23 4v6h-6"></path>
                            <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path>
                        </svg>
                    </div>
                    <div id="seasonal-info" class="hidden"
                        style="position: absolute; bottom: 100%; left: 50%; transform: translateX(-50%); width: 280px; background: #ffffff; color: #162233; padding: 16px; border-radius: 12px; font-size: 0.9rem; text-transform: none; text-align: left; margin-bottom: 32px; box-shadow: 0 20px 50px rgba(0,0,0,0.4); z-index: 100;">
                        <div onclick="this.parentElement.classList.add('hidden')"
                            style="position: absolute; top: 12px; right: 12px; cursor: pointer; opacity: 0.5; padding: 4px;">
                            <svg width="12" height="12" viewBox="0 0 14 14" fill="none" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <line x1="1" y1="1" x2="13" y2="13"></line>
                                <line x1="1" y1="13" x2="13" y2="1"></line>
                            </svg>
                        </div>
                        <h4
                            style="margin: 0 0 8px 0; font-size: 1.05rem; color: #162233; font-weight: 700; padding-right: 16px;">
                            Slik vektes
                            årsveksten på
                            sesonger</h4>
                        <p style="margin: 0 0 12px 0; color: #162233; line-height: 1.4;">
                            <span style="color: #3b82f6; font-weight: 700;">Sesongmønsteret er front‑lastet:</span> Den
                            årlige prisutviklingen fordeles ulikt på kvartalene for
                            å speile historiske mønstre i Oslo‑markedet.
                        </p>
                        <p style="margin: 0 0 4px 0; font-weight: 600; color: #162233;">Vektene som brukes er faste:</p>
                        <ul
                            style="margin: 0 0 12px 0; padding-left: 16px; color: #162233; display: grid; grid-template-columns: 1fr 1fr; gap: 4px;">
                            <li>Q1: 45%</li>
                            <li>Q2: 27,5%</li>
                            <li>Q3: 19,5%</li>
                            <li>Q4: 8%</li>
                        </ul>
                        <p style="margin: 0; color: #475569; font-size: 0.85rem; line-height: 1.3;">
                            <strong>Komponert beregning:</strong> Hver kvartalsvekst beregnes slik at sammensatt effekt
                            av alle fire kvartaler alltid gir nøyaktig den årlige prosenten du har angitt.
                        </p>
                    </div>
                </div>
                <div class="growth-row">
                    <!-- 2026 -->
                    <div class="input-wrapper">
                        <div id="growth-2026" class="growth-input-div">
                            <span style="color: #1e293b;">2026:</span> <span style="color: #16a34a;">+5.0 %</span>
                        </div>
                        <div class="custom-spinners">
                            <button class="spin-btn up" onclick="adjustInput('growth-2026', 0.5)">
                                <svg width="8" height="5" viewBox="0 0 10 6" fill="none">
                                    <path d="M1 5L5 1L9 5" stroke="currentColor" stroke-width="1.5"
                                        stroke-linecap="round" stroke-linejoin="round" />
                                </svg>
                            </button>
                            <button class="spin-btn down" onclick="adjustInput('growth-2026', -0.5)">
                                <svg width="8" height="5" viewBox="0 0 10 6" fill="none">
                                    <path d="M1 1L5 5L9 1" stroke="currentColor" stroke-width="1.5"
                                        stroke-linecap="round" stroke-linejoin="round" />
                                </svg>
                            </button>
                        </div>
                    </div>

                    <!-- 2027 -->
                    <div class="input-wrapper">
                        <div id="growth-2027" class="growth-input-div">
                            <span style="color: #1e293b;">2027:</span> <span style="color: #16a34a;">+9.5 %</span>
                        </div>
                        <div class="custom-spinners">
                            <button class="spin-btn up" onclick="adjustInput('growth-2027', 0.5)">
                                <svg width="8" height="5" viewBox="0 0 10 6" fill="none">
                                    <path d="M1 5L5 1L9 5" stroke="currentColor" stroke-width="1.5"
                                        stroke-linecap="round" stroke-linejoin="round" />
                                </svg>
                            </button>
                            <button class="spin-btn down" onclick="adjustInput('growth-2027', -0.5)">
                                <svg width="8" height="5" viewBox="0 0 10 6" fill="none">
                                    <path d="M1 1L5 5L9 1" stroke="currentColor" stroke-width="1.5"
                                        stroke-linecap="round" stroke-linejoin="round" />
                                </svg>
                            </button>
                        </div>
                    </div>

                    <!-- 2028 -->
                    <div class="input-wrapper">
                        <div id="growth-2028" class="growth-input-div">
                            <span style="color: #1e293b;">2028:</span> <span style="color: #16a34a;">+8.5 %</span>
                        </div>
                        <div class="custom-spinners">
                            <button class="spin-btn up" onclick="adjustInput('growth-2028', 0.5)">
                                <svg width="8" height="5" viewBox="0 0 10 6" fill="none">
                                    <path d="M1 5L5 1L9 5" stroke="currentColor" stroke-width="1.5"
                                        stroke-linecap="round" stroke-linejoin="round" />
                                </svg>
                            </button>
                            <button class="spin-btn down" onclick="adjustInput('growth-2028', -0.5)">
                                <svg width="8" height="5" viewBox="0 0 10 6" fill="none">
                                    <path d="M1 1L5 5L9 1" stroke="currentColor" stroke-width="1.5"
                                        stroke-linecap="round" stroke-linejoin="round" />
                                </svg>
                            </button>
                        </div>
                    </div>

                    <!-- 2029 -->
                    <div class="input-wrapper">
                        <div id="growth-2029" class="growth-input-div">
                            <span style="color: #1e293b;">2029:</span> <span style="color: #16a34a;">+6.0 %</span>
                        </div>
                        <div class="custom-spinners">
                            <button class="spin-btn up" onclick="adjustInput('growth-2029', 0.5)">
                                <svg width="8" height="5" viewBox="0 0 10 6" fill="none">
                                    <path d="M1 5L5 1L9 5" stroke="currentColor" stroke-width="1.5"
                                        stroke-linecap="round" stroke-linejoin="round" />
                                </svg>
                            </button>
                            <button class="spin-btn down" onclick="adjustInput('growth-2029', -0.5)">
                                <svg width="8" height="5" viewBox="0 0 10 6" fill="none">
                                    <path d="M1 1L5 5L9 1" stroke="currentColor" stroke-width="1.5"
                                        stroke-linecap="round" stroke-linejoin="round" />
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
            </div>


            <div id="scenario-hint"
                style="position: absolute; bottom: 100px; left: 350px; color: white; font-size: 0.9rem; max-width: 300px; line-height: 1.4; font-weight: 500; text-shadow: 0 2px 4px rgba(0,0,0,0.5); pointer-events: none; opacity: 0; animation: fadeIn 1s 1s ease-out forwards;">
                <span style="font-size: 1.2rem; vertical-align: middle; margin-right: 8px;">&larr;</span> Endre anslag
                for
                utviklingen i boligprisene for å regne på forskjellige scenarier
            </div>

        </main>

        <!-- Right Side Panel -->
        <aside class="side-panel" id="detail-panel">
            <div class="empty-state">
                <p>Velg et prosjekt i kartet for å se detaljer</p>
            </div>
        </aside>
    </div>

    <!-- Fun Car Effect (Hidden for now but keeping structure) -->
    <div id="car-rig" style="display: none;">
        <div class="banner-string"></div>
        <div class="banner">Espen Torbjørn Ali lag</div>
        <div class="passengers">
            <img src="ali_new.png" class="face face-1" alt="Ali">
            <img src="torbjorn_new.jpg" class="face face-2" alt="Torbjørn">
            <img src="espen_new.jpg" class="face face-3" alt="Espen">
        </div>
        <img src="red_car.png" class="car-body" alt="Rask bil">
    </div>

    <div id="modal-overlay" class="hidden">
        <div id="project-modal">
            <button id="close-modal" aria-label="Lukk">&times;</button>
            <div class="modal-content">
                <div class="modal-image-container">
                    <img id="modal-image" src="" alt="Prosjekt bilde">
                </div>
                <div class="modal-details">
                    <h2 id="modal-title">Prosjektnavn</h2>
                    <p class="area-tag" id="modal-area">Område</p>
                    <p id="modal-desc">Beskrivelse kommer her.</p>
                    <div class="modal-stats">
                        <!-- Stats Grid injected by JS -->
                    </div>
                    <div id="modal-actions" style="margin-top: 20px;">
                        <!-- Buttons injected here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="script.js?v=174"></script>
</body>

</html>